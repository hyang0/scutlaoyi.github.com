<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Arch Linux学习：安装篇(二)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="laoyi">

    <!-- Le styles -->
    <link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
        <link href="/theme/css/font-awesome.css" rel="stylesheet">

    <link href="/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/theme/images/apple-touch-icon-114x114.png">

    <link href="/" type="application/atom+xml" rel="alternate" title="老逸的个人站 ATOM Feed" />
    <link href="/feeds/all.rss.xml" type="application/atom+xml" rel="alternate" title="老逸的个人站 RSS Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/index.html">老逸的个人站 </a>
          <div class="nav-collapse">
            <ul class="nav">
                <li><a href="/pages/about.html">About</a></li>
                          <li class="divider-vertical"></li>
                  <li >
                    <a href="/category/coding.html">
						<i class="icon-folder-open icon-large"></i>Coding
					</a>
                  </li>
                  <li >
                    <a href="/category/life.html">
						<i class="icon-folder-open icon-large"></i>Life
					</a>
                  </li>
                  <li class="active">
                    <a href="/category/linux.html">
						<i class="icon-folder-open icon-large"></i>Linux
					</a>
                  </li>
                  <li >
                    <a href="/category/tool.html">
						<i class="icon-folder-open icon-large"></i>Tool
					</a>
                  </li>
                  <li >
                    <a href="/category/web.html">
						<i class="icon-folder-open icon-large"></i>Web
					</a>
                  </li>

                          <ul class="nav pull-right">
                                <li><a href="/archives.html"><i class="icon-th-list"></i>Archives</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h1>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to Arch Linux学习：安装篇(二)">
                                        Arch Linux学习：安装篇(二)
                                </a>
                        </h1>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2014-01-14T19:30:00+08:00">
        <i class="icon-calendar"></i>二 14 一月 2014
</abbr>
<span class="label">By</span>
<a href="/author/laoyi.html"><i class="icon-user"></i>laoyi</a>
<span class="label">Category</span>
<a href="/category/linux.html"><i class="icon-folder-open"></i>Linux</a>.


<span class="label">Tags</span>
	<a href="/tag/arch-linux.html"><i class="icon-tag"></i>Arch Linux</a>
</footer><!-- /.post-info -->                </div>
                <p>本系列博文记录学习Arch Linux这个Linux发行版过程中的总结与收获。</p>
<hr class="docutils" />
<p>当你看到这篇博文的时候，
老逸的新系统已安装完毕，
弹冠相庆！^_^</p>
<p>替换掉原来恶心的win7+Ubuntu双系统，
现在直接将整个硬盘重新分区并安装Arch Linux.</p>
<p>分区如下:</p>
<pre class="literal-block">
NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sda      8:0    0 298.1G  0 disk
├─sda1   8:1    0   500M  0 part /boot
├─sda2   8:2    0    50G  0 part /
├─sda3   8:3    0     2G  0 part [SWAP]
├─sda4   8:4    0   100G  0 part /home
└─sda5   8:5    0 145.6G  0 part /data
</pre>
<p>除了swap外所有分区均使用ext4。
根据Arch官方说法，留多25%的空间能够消除碎片，
考虑到300G硬盘的实际使用率，因此确定了上面的分区方案。</p>
<p>boot分区给了夸张的500M，因为1G以下的空间对现在的硬盘来说都不够算。
root分区因为要装一些软件什么的，考虑到之前的Ubuntu只有10G也没用尽，因此给了50G以防以后拓展。
home分区用来存自己的数据，文档啦源码啦，还有我这网站的content也在里面，乱七八糟的都放，给了个100G。
剩下的统统交给data，计划用来放些电影啦音乐啥子的，这种搞法其实是Arch的文档中介绍的。</p>
<p>基本配置如下，列表以供参考：</p>
<pre class="literal-block">
partition table: GPT
bootloader: syslinux
linux kernal: 3.12.6-1-ARCH (tobias&#64;T-POWA-LX)
Desktop Environment: Lightweight X11 Desktop Environment(LXDE)
</pre>
<p>由于确定不再使用windows，所以完全没有考虑双系统的兼容性问题，带来的好处就是可以直接使用新款分区表GPT，
相比老旧的MBR确实优势多多。
bootloader也相应选择了看起来更加牛逼一些的syslinux，安装过程也非常顺利方便。（当然，相比windows的无人值守性质的安装还是多少有一些事情要做的。不过windows嘛，就不说什么了...）
内核就没有自己geek一番了，毕竟是生手第一次安装，主要考虑系统的稳定性和便捷性，直接pacstrap搞定。</p>
<p>应用软件方面还是以轻量级为主。</p>
<p>桌面环境直接排除了GNOME和KDE，GNOME虽然效果非常炫，但用起来机器居然有时会卡，而且GNOME本身也过于庞大。
KDE的话，看到Arch官网的介绍和GNOME同属重量级的环境，就一起排除了。
在xfce和LXDE之间纠结了很久，因为这俩货主打轻量级，而且是官方支持的版本。
之前用的是xfce，考虑到尝鲜的因素、浏览器的因素（LXDE推荐网页浏览器是Firefox），以及其他心理因素，最终确定使用LXDE作为桌面环境。</p>
<p>输入法本来安装了ibus和googlepinyin，用了两次感觉比较不爽，默认的界面非常难看，而且启动也有点慢（居然要我开启完桌面环境好一会之后才自己慢吞吞出现在菜单栏里）。
所以果断换了fcitx。刚换上去就知道找对东西了，不仅开启的速度非常快，不用怎么配置，而且默认的黑色界面也和我的桌面主题很搭。再装上google拼音，好用的很。</p>
<p>浏览器就Firefox无疑了，autoProxy用起来忒爽。这里插句题外话，前天给家里的winXP(老古董，想换个Lubuntu，但不是我在用，麻烦。=_=)装Firefox，居然下错Firefox搞到一个中国版，各种插件各种弹窗，各种恶心...提醒大家装Firefox去官网选择中文原版，别去中国官网下，当然故意找插件的除外。</p>
<div class="section" id="id1">
<h2>桌面环境的安装</h2>
<p>安装桌面环境首先要安装xorg-server，直接pacman就行。</p>
<p>接着是mesa，据说是用来处理3D显示的。</p>
<p>然后要搞定显卡的驱动。</p>
<p>从这里：</p>
<blockquote>
<a class="reference external" href="https://wiki.archlinux.org/index.php/Xorg#Driver_installation">https://wiki.archlinux.org/index.php/Xorg#Driver_installation</a></blockquote>
<p>可以找到自己显卡对应的驱动，pacman安装即可。</p>
<p>现在便可以通过启动X来测试了，直接命令：startx
如果能出几个框框鼠标能动，说明安装正确，不行的话就找troubleshooting咯。</p>
<p>安装好X便可以选择一个桌面环境自己安装了，所谓的根据喜好选择。 ^_^</p>
<p>最后是一些配置什么的，就不赘述了。</p>
</div>
<div class="section" id="id2">
<h2>杂七杂八的经验</h2>
<div class="section" id="id3">
<h3>关于虚拟机</h3>
<p>虚拟机的安装很容易出现问题，
上回博主在virtualbox里安装的时候曾经在bootloader里卡很久，
所有的配置都没有问题，但敲回车选择进入Arch，屏幕闪了一下又跳回bootloader主界面。</p>
<p>查文档说如果敲了回车什么事情都没有发生，说明是配置错误引导系统失败。</p>
<p>但是多敲几次回车它却偶尔会进系统，并且系统完全正常...</p>
<p>此外，显示器的识别也出现过问题。
在virtualbox里startx失败，报错为：没有找到显示器</p>
<p>所幸这些问题在自己的真机里都没有出现，一切顺利。</p>
</div>
<div class="section" id="mirrorlist">
<h3>关于mirrorlist</h3>
<p>有了虚拟机的麻烦经历，
实体安装的时候我把mirrorlist内容全部换成国内几个速度很快的服务器，
效果非常好，
速度一般都有几百K到几个M。</p>
<p>不过遇到了另一个问题，
不知为何国内的服务器某些软件找不到。
具体的忘记了，但有不少的软件在国内的服务器返回了404，导致pacman报错。</p>
<p>于是不得不再次更改mirrorlist加几个山姆大叔家的服务器。</p>
<p>最终的最佳实践是：
首先放几个离自己的地域最近的服务器（相同国家一般就可以了）。
然后在文件的末尾放几个山姆大叔的主力服务器，找那些score高的，用于国内服务器找不到资源时的备用。
要注意把远程的服务器放在文件末尾，因为pacman是按顺序搜索的。</p>
<p>另外，千万要记得的是，每次更新mirrorlist要敲这个：</p>
<blockquote>
pacman -Syy</blockquote>
</div>
<div class="section" id="id4">
<h3>关于时间</h3>
<p>时间的同步可以按教程搞：</p>
<blockquote>
<a class="reference external" href="https://wiki.archlinux.org/index.php/Network_Time_Protocol">https://wiki.archlinux.org/index.php/Network_Time_Protocol</a></blockquote>
<p>官方的说法是，没有启动deamon的情况下敲这个：</p>
<blockquote>
ntpd -q</blockquote>
<p>不过我倒是没搞定 -_-</p>
<p>貌似服务器连接有问题，
而且更恶心的是同步失败是没有任何出错提示的。</p>
<p>最后在google上找到另一款方案：</p>
<blockquote>
ntpdate 0.us.pool.ntp.org</blockquote>
<p>记得写入硬件时钟：</p>
<blockquote>
hwclock -w</blockquote>
</div>
<div class="section" id="id5">
<h3>一些好用的命令</h3>
<p><strong>lsblk</strong></p>
<p>这货最近敲了很多次，不带参数则显示所有存储设备的分区情况，也可以加入参数限定显示的设备。</p>
<p>博文最前面的分区信息显示就是用lsblk打出来的。</p>
<p><strong>ip link</strong></p>
<p>搞网络也花了一些时间。</p>
<p>这货显示当前所有网络设备的详细信息。</p>
<p>启动某个设备敲：</p>
<blockquote>
ip link set [device] up</blockquote>
<p>其中device是设备的名称，在ip link输出中的第一个便是。
一般来说e开头的是有线网卡，wl开头的是无线网卡。lo据称是本地的回路，不是真实网卡。</p>
<p>然后自己被坑的地方是这里：</p>
<p>教程说首先使用ip link set让对应的设备state为up，然后便可以连接。
但要注意的是这种说法对应的是有线网卡的情况。
如果是无线网卡，直接set是没法让它从down变成up的，
只有成功创建连接后自己才会更改状态。</p>
<p>于是我花了好久时间一直在研究为何没法让它up，
而google到的结果看样子没有人遇到这种奇葩情况。
直到第二天睡醒想想算了不管它直接用wifi-menu连接看看，
一试才发现这货根本就没有问题。</p>
<p><strong>wifi-menu 和 dhcpcd</strong></p>
<p>两个方便的东西，wifi-menu加上无线网卡的设备名作为参数，
自动搜索并列表显示所有找到的网络，
还能输入密码自动创建连接。</p>
<p>而dhcpcd可以用在有线网卡里，
默认状态下网卡是down的，用上面的ip link让它up，
然后直接敲dhcpcd，
全自动连接并从路由的dhcp服务里获取并设置网络。
一般根据自己的网络环境选用上面俩命令的一个，成功执行便能ping www.google.com了。</p>
<hr class="docutils" />
<p>下一次将尝试安装virtualbox，据说很难搞...</p>
</div>
</div>

                </div><!-- /.entry-content -->
        </article>
        <license>
        <br/>
        This work by <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.scutlaoyi.tk" property="cc:attributionName" rel="cc:attributionURL">scutLaoYi</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
        </license>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4><i class="icon-time"></i>time</h4></li>
<li><p id="pagetimer"></p></li>

<li class="nav-header"><h4><i class="icon-list-alt"></i>PAGE SENTENCE</h4></li>
<li>
<p id="page-sentence">
当你看到这句的时候，说明每页一句载入失败...烦请告知博主!谢谢!(^_^)
</p>
</li>
<script src="/add_ons/pagesentence/sentence.js"></script>
<script src="/add_ons/clock/clock.js"></script>
<script>
window.onload=function(){
      var pagetimer = document.getElementById("pagetimer");
      pagetimer.innerHTML = getcurrenttime();
  setInterval(function(){
      pagetimer.innerHTML = getcurrenttime();
      }, 1000);

    document.getElementById("page-sentence").innerHTML = generateSentence();
}
</script>
<li class="nav-header"><h4><i class="icon-external-link"></i>link</h4></li>
    <li><a href="http://github.com/scutlaoyi"><i class="icon-external-link"></i>my github</a></li>
<li class="nav-header"><h4><i class="icon-home icon-large"></i> social</h4></li>
<!--<li><a href="/" rel="alternate"><i
    class="icon-bookmark icon-large"></i>atom feed</a></li>-->
<li><a href="/feeds/all.rss.xml" rel="alternate"><i class="icon-bookmark icon-large"></i>rss feed</a></li>
    <li><a href=""><i class="icon--sign icon-large"></i></a></li>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>
<li>
<a href="/category/coding.html">
    <i class="icon-folder-open icon-large"></i>Coding
</a>
</li>
<li>
<a href="/category/life.html">
    <i class="icon-folder-open icon-large"></i>Life
</a>
</li>
<li>
<a href="/category/linux.html">
    <i class="icon-folder-open icon-large"></i>Linux
</a>
</li>
<li>
<a href="/category/tool.html">
    <i class="icon-folder-open icon-large"></i>Tool
</a>
</li>
<li>
<a href="/category/web.html">
    <i class="icon-folder-open icon-large"></i>Web
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>
<li class="tag-4">
    <a href="/tag/mysql.html">
        <i class="icon-tag icon-large"></i>MySQL
    </a>
</li>
<li class="tag-2">
    <a href="/tag/audition.html">
        <i class="icon-tag icon-large"></i>audition
    </a>
</li>
<li class="tag-3">
    <a href="/tag/litecoin.html">
        <i class="icon-tag icon-large"></i>litecoin
    </a>
</li>
<li class="tag-4">
    <a href="/tag/android.html">
        <i class="icon-tag icon-large"></i>Android
    </a>
</li>
<li class="tag-4">
    <a href="/tag/meek.html">
        <i class="icon-tag icon-large"></i>Meek
    </a>
</li>
<li class="tag-1">
    <a href="/tag/python.html">
        <i class="icon-tag icon-large"></i>Python
    </a>
</li>
<li class="tag-1">
    <a href="/tag/cc.html">
        <i class="icon-tag icon-large"></i>C/C++
    </a>
</li>
<li class="tag-2">
    <a href="/tag/github.html">
        <i class="icon-tag icon-large"></i>github
    </a>
</li>
<li class="tag-2">
    <a href="/tag/web-tool.html">
        <i class="icon-tag icon-large"></i>web tool
    </a>
</li>
<li class="tag-4">
    <a href="/tag/openwrt.html">
        <i class="icon-tag icon-large"></i>OpenWrt
    </a>
</li>
<li class="tag-1">
    <a href="/tag/data-structure.html">
        <i class="icon-tag icon-large"></i>data structure
    </a>
</li>
<li class="tag-1">
    <a href="/tag/arch-linux.html">
        <i class="icon-tag icon-large"></i>Arch Linux
    </a>
</li>
<li class="tag-4">
    <a href="/tag/gae.html">
        <i class="icon-tag icon-large"></i>GAE
    </a>
</li>
<li class="tag-4">
    <a href="/tag/page-sentences.html">
        <i class="icon-tag icon-large"></i>page sentences
    </a>
</li>
<li class="tag-3">
    <a href="/tag/vim.html">
        <i class="icon-tag icon-large"></i>Vim
    </a>
</li>
<li class="tag-2">
    <a href="/tag/socket.html">
        <i class="icon-tag icon-large"></i>socket
    </a>
</li>
<li class="tag-3">
    <a href="/tag/proxy.html">
        <i class="icon-tag icon-large"></i>proxy
    </a>
</li>
<li class="tag-2">
    <a href="/tag/bash.html">
        <i class="icon-tag icon-large"></i>Bash
    </a>
</li>
<li class="tag-2">
    <a href="/tag/git.html">
        <i class="icon-tag icon-large"></i>git
    </a>
</li>
<li class="tag-4">
    <a href="/tag/md5.html">
        <i class="icon-tag icon-large"></i>md5
    </a>
</li>
<li class="tag-2">
    <a href="/tag/recruitment.html">
        <i class="icon-tag icon-large"></i>recruitment
    </a>
</li>
<li class="tag-2">
    <a href="/tag/softwarearchitect.html">
        <i class="icon-tag icon-large"></i>SoftwareArchitect
    </a>
</li>
<li class="tag-4">
    <a href="/tag/xss.html">
        <i class="icon-tag icon-large"></i>xss
    </a>
</li>
<li class="tag-3">
    <a href="/tag/tor.html">
        <i class="icon-tag icon-large"></i>Tor
    </a>
</li>


</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer>
        <address id="about">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican <i class="icon-external-link"></i></a>,
                                which takes great advantage of <a href="http://python.org">Python <i class="icon-external-link"></i></a>.
        </address><!-- /#about -->

        <p>The theme is from <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter <i class="icon-external-link"></i></a>,
                   and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome <i class="icon-external-link"></i></a>, thanks!</p>
      </footer>

    </div><!--/.fluid-container-->



    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/theme/js/jquery-1.7.2.min.js"></script>
    <script src="/theme/js/bootstrap.min.js"></script>
  </body>
</html>